<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Adrian + CAD Command Hub</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="wrap">
  <div class="top">
    <div class="brand">Adrian + CAD Command Hub</div>
    <div class="time" id="clock">--:--:--</div>
  </div>

  <div class="layout">
    <aside class="card side">
      <div class="title">Navigation</div>
      <div class="menu" id="menu">
        <button class="active" data-panel="overview">Adrian Dashboard</button>
        <button data-panel="cad">CAD Dashboard</button>
        <button data-panel="content">Content Hub</button>
        <button data-panel="offer">Offer Lab</button>
        <button data-panel="tasks">Universal Tasks</button>
        <button data-panel="chat">Chat</button>
      </div>

      <div style="margin-top:12px" class="title">Quick Links</div>
      <a class="btn" href="content.html">Legacy Content</a>
      <a class="btn" href="projects.html">Legacy Projects</a>
      <a class="btn" href="fitness.html">Legacy Fitness</a>
    </aside>

    <main>
      <section id="overview" class="panel active">
        <div class="kpis">
          <div class="card kpiBox"><div class="title">Year Target</div><div class="kpi" id="yearTarget">100,000</div></div>
          <div class="card kpiBox"><div class="title">Total Followers</div><div class="kpi" id="totalFollowers">18,960</div></div>
          <div class="card kpiBox"><div class="title">Progress</div><div class="kpi" id="progress">18.9%</div></div>
          <div class="card kpiBox"><div class="title">Updated</div><div class="kpi" id="updated">manual</div></div>
        </div>

        <div class="card widget" style="margin-top:10px">
          <div class="title">Current Doctrine</div>
          <div class="quote" id="quote">Build the body. Build the mind. Build the life worth inheriting.</div>
          <span class="tag">Discipline</span><span class="tag">Execution</span><span class="tag">Reality</span>
        </div>

        <div class="three">
          <div class="card widget">
            <div class="title">Platform Split</div>
            <div class="sub">Instagram: <b id="ig">12,400</b></div><div class="track"><div id="igBar" class="fill" style="width:62%"></div></div>
            <div class="sub">TikTok: <b id="tt">6,000</b></div><div class="track"><div id="ttBar" class="fill" style="width:31%"></div></div>
            <div class="sub">YouTube: <b id="yt">560</b></div><div class="track"><div id="ytBar" class="fill" style="width:5%"></div></div>
          </div>
          <div class="card widget gridline">
            <div class="title">Execution Pulse</div>
            <div class="spark"></div>
          </div>
          <div class="card widget gridline">
            <div class="title">Build Velocity</div>
            <div class="spark"></div>
          </div>
        </div>
      </section>

      <section id="cad" class="panel">
        <div class="card widget">
          <div class="title">What I’m Building</div>
          <div class="sub" id="cadFocus">Loading...</div>
          <ul id="cadNext"></ul>
        </div>
        <div class="card widget" style="margin-top:10px">
          <div class="title">Activity Feed</div>
          <div id="cadFeed" class="feed"></div>
        </div>
      </section>

      <section id="content" class="panel">
        <div class="two">
          <div class="card widget">
            <div class="title">Ideas Backlog</div>
            <textarea id="ideasBox" rows="8" placeholder="Drop hooks, series ideas, rants..."></textarea>
            <button class="btn2" id="saveIdeas" style="margin-top:8px">Save Ideas</button>
          </div>
          <div class="card widget">
            <div class="title">Top Video Analyzer</div>
            <input id="csvFile" class="input" type="file" accept=".csv" />
            <button class="btn2" id="analyzeBtn" style="margin-top:8px">Analyze CSV</button>
            <div class="tableWrap" style="margin-top:10px"><table id="rankTable"><thead><tr><th>#</th><th>Title</th><th>Views</th><th>Score</th></tr></thead><tbody></tbody></table></div>
          </div>
        </div>
      </section>

      <section id="offer" class="panel">
        <div class="card widget">
          <div class="title">Offer Lab — Body · Mind · Reality</div>
          <div class="two">
            <input id="offerName" class="input" placeholder="Offer name">
            <input id="offerPrice" class="input" placeholder="Price">
          </div>
          <textarea id="offerPromise" rows="3" placeholder="Core promise" style="margin-top:8px"></textarea>
          <textarea id="offerCTA" rows="2" placeholder="Primary CTA" style="margin-top:8px"></textarea>
          <div style="display:flex;gap:8px;margin-top:8px"><button class="btn2" id="saveOffer">Save Draft</button><button class="btn2" id="clearOffer">Clear</button></div>
          <div class="sub" id="offerSavedAt" style="margin-top:8px"></div>
        </div>
      </section>

      <section id="tasks" class="panel">
        <div class="two">
          <div class="card widget">
            <div class="title">Daily Tasks</div>
            <div style="display:flex;gap:8px"><input id="taskInput" class="input" placeholder="Add daily task"><button class="btn2" id="addTask">Add</button></div>
            <ul id="taskList"></ul>
          </div>
          <div class="card widget">
            <div class="title">Weekly Tasks</div>
            <div style="display:flex;gap:8px"><input id="weeklyInput" class="input" placeholder="Add weekly task"><button class="btn2" id="addWeekly">Add</button></div>
            <ul id="weeklyList"></ul>
          </div>
        </div>
      </section>

      <section id="chat" class="panel">
        <div class="card widget">
          <div class="title">Chat</div>
          <div class="sub">MVP: open Telegram directly.</div>
          <a class="btn" href="https://t.me/adriandelaneyiv" target="_blank" style="margin-top:8px">Open Telegram</a>
        </div>
      </section>
    </main>
  </div>
</div>

<script>
const $=id=>document.getElementById(id);
setInterval(()=>clock.textContent=new Date().toLocaleTimeString(),1000); clock.textContent=new Date().toLocaleTimeString();

// nav
for (const b of document.querySelectorAll('#menu button')) {
  b.onclick=()=>{document.querySelectorAll('#menu button').forEach(x=>x.classList.remove('active')); b.classList.add('active'); document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active')); $(b.dataset.panel).classList.add('active');}
}

const fmt=n=>Number(n||0).toLocaleString();
async function loadSocial(){
  try{
    const d=await (await fetch('social-data.json?'+Date.now())).json();
    const t=d.totals||{}; const total=t.total||0; const target=t.yearTarget||100000;
    yearTarget.textContent=fmt(target); totalFollowers.textContent=fmt(total); progress.textContent=((100*total/target)||0).toFixed(1)+'%';
    updated.textContent=(d.lastUpdated||'manual').toString().slice(0,16); ig.textContent=fmt(t.instagram); tt.textContent=fmt(t.tiktok); yt.textContent=fmt(t.youtube);
    const pct=v=>Math.max(2,Math.min(100,(100*(v||0)/target))); igBar.style.width=pct(t.instagram)+'%'; ttBar.style.width=pct(t.tiktok)+'%'; ytBar.style.width=pct(t.youtube)+'%';
  } catch {}
}

async function loadCad(){
  try{
    const d=await (await fetch('cad-data.json?'+Date.now())).json();
    cadFocus.textContent=(d.focus||'')+' — '+(d.nowDoing||'');
    cadNext.innerHTML=(d.nextUp||[]).map(x=>`<li>${x}</li>`).join('');
    cadFeed.innerHTML=(d.activityFeed||[]).map(e=>`<div class='evt'><div class='dot'></div><div><div>${e.event}</div><div class='sub'>${e.time}</div></div></div>`).join('');
  } catch {}
}

// content ideas
ideasBox.value=localStorage.getItem('cad_ideas')||'';
saveIdeas.onclick=()=>localStorage.setItem('cad_ideas',ideasBox.value);

// csv analyzer
function parseCSV(text){const rows=text.split(/\r?\n/).filter(Boolean); if(!rows.length) return []; const h=rows[0].split(',').map(x=>x.trim().toLowerCase()); return rows.slice(1).map(r=>{const c=r.split(','); const o={}; h.forEach((k,i)=>o[k]=(c[i]||'').trim()); return o;});}
function num(v){return Number(String(v||'0').replace(/[^0-9.]/g,''))||0;}
analyzeBtn.onclick=async()=>{if(!csvFile.files[0]) return; const rows=parseCSV(await csvFile.files[0].text()); const scored=rows.map(r=>{const views=num(r.views||r.plays); const score=views+num(r.likes)*2+num(r.comments)*3+num(r.shares)*4; return {title:r.title||r.caption||'untitled',views,score:Math.round(score)}}).sort((a,b)=>b.score-a.score).slice(0,20); rankTable.querySelector('tbody').innerHTML=scored.map((r,i)=>`<tr><td>${i+1}</td><td>${r.title}</td><td>${fmt(r.views)}</td><td>${fmt(r.score)}</td></tr>`).join('');};

// offer draft
const offer=JSON.parse(localStorage.getItem('cad_offer_draft')||'{}'); offerName.value=offer.name||''; offerPrice.value=offer.price||''; offerPromise.value=offer.promise||''; offerCTA.value=offer.cta||''; if(offer.savedAt) offerSavedAt.textContent='Saved: '+offer.savedAt;
saveOffer.onclick=()=>{const o={name:offerName.value.trim(),price:offerPrice.value.trim(),promise:offerPromise.value.trim(),cta:offerCTA.value.trim(),savedAt:new Date().toLocaleString()}; localStorage.setItem('cad_offer_draft',JSON.stringify(o)); offerSavedAt.textContent='Saved: '+o.savedAt;};
clearOffer.onclick=()=>{offerName.value='';offerPrice.value='';offerPromise.value='';offerCTA.value='';localStorage.removeItem('cad_offer_draft'); offerSavedAt.textContent='';};

// daily + weekly tasks
let tasks=JSON.parse(localStorage.getItem('cad_tasks')||'[]');
let weekly=JSON.parse(localStorage.getItem('cad_weekly_tasks')||'[]');
function renderTasks(){taskList.innerHTML=tasks.map((t,i)=>`<li><label><input type='checkbox' ${t.done?'checked':''} onchange='toggleTask(${i})'> ${t.text}</label></li>`).join('');}
function renderWeekly(){weeklyList.innerHTML=weekly.map((t,i)=>`<li><label><input type='checkbox' ${t.done?'checked':''} onchange='toggleWeekly(${i})'> ${t.text}</label></li>`).join('');}
window.toggleTask=(i)=>{tasks[i].done=!tasks[i].done; localStorage.setItem('cad_tasks',JSON.stringify(tasks)); renderTasks();};
window.toggleWeekly=(i)=>{weekly[i].done=!weekly[i].done; localStorage.setItem('cad_weekly_tasks',JSON.stringify(weekly)); renderWeekly();};
addTask.onclick=()=>{const t=taskInput.value.trim(); if(!t) return; tasks.push({text:t,done:false}); taskInput.value=''; localStorage.setItem('cad_tasks',JSON.stringify(tasks)); renderTasks();};
addWeekly.onclick=()=>{const t=weeklyInput.value.trim(); if(!t) return; weekly.push({text:t,done:false}); weeklyInput.value=''; localStorage.setItem('cad_weekly_tasks',JSON.stringify(weekly)); renderWeekly();};
renderTasks(); renderWeekly();

const quotes=['Build the body. Build the mind. Build the life worth inheriting.','No risk. No Porsche. No excuses.','Obsession beats talent when talent stays comfortable.','Quiet execution. Loud results.'];
let qi=0; setInterval(()=>{qi=(qi+1)%quotes.length; quote.textContent=quotes[qi];},6500);

loadSocial(); loadCad(); setInterval(loadSocial,18000); setInterval(loadCad,10000);
</script>
</body>
</html>